/*! Descartes v0.0.1-pre | (c) Jon Chan @jonhmchan | descartes.io/license */
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Descartes=function(){function e(t){_classCallCheck(this,e),this.tree=t,this.mappings={},this.selector="selector",this.rule="rule",this.meta="meta",this.mixins="_mixins",this.listeners="_listeners",this.prefixes=["-webkit-","-moz-","-o-","-ms-"],this.rules=["align-content","align-items","align-self","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","caption-side","clear","clip","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","cursor","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font","@font-face","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","hanging-punctuation","height","justify-content","@keyframes","left","letter-spacing","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","max-height","max-width","@media","min-height","min-width","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","perspective","perspective-origin","position","quotes","resize","right","tab-size","table-layout","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-indent","text-justify","text-overflow","text-shadow","text-transform","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","white-space","width","word-break","word-spacing","word-wrap","z-index"],this.findType=void 0,this.find=this.findLibrary(),this.render()}return _createClass(e,[{key:"findLibrary",value:function(){return"undefined"!=typeof $?(this.findType="jquery",$):"undefined"!=typeof Sizzle?(this.findType="sizzle",Sizzle):void 0}},{key:"compute",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.tree:arguments[0];if("object"===("undefined"==typeof e?"undefined":_typeof(e))){var t={};for(var i in e){var n=e[i],r=this.parseKey(i);if(r.type===this.selector)t[r.key]=this.compute(n);else if(r.type===this.rule)t[r.key]=n;else if(r.type===this.meta)if(r.key===this.mixins){var o=this.parseMixins(e,i);t=o}else r.key===this.listeners&&(t[r.key]=n)}return t}return null}},{key:"flatten",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.compute(e):arguments[0],t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];for(var i in e){var n=Object.assign({},e[i]),r=n[this.listeners];for(var o in n)if(!this.isRule(o)){var a=null;""===t&&(t=i);var s=this.nestSelector(o,t);this.isMeta(o)||this.isRule(o)||(a={},a[s]=n[o]),delete n[o],null!==a&&this.flatten(a,s)}this.mappings[i]={rules:n,_listeners:r}}return this.mappings}},{key:"render",value:function(){this.flatten(),console.log(this.mappings),this.bindListeners(),this.applyAll()}},{key:"bindListeners",value:function(){var e=this,t=function(t){var i=e.mappings[t],n=i[e.listeners];if("undefined"==typeof n)return"continue";var r=i.rules;n.map(function(i){"string"==typeof i[0]?"jquery"==e.findType?e.find(i[0]).map(function(n){n.bind(i[1],function(){e.apply(t,r)})}):"sizzle"===e.findType&&e.find(i[0]).map(function(n){n.addEventListener(i[1],function(){e.apply(t,r)})}):i[0].addEventListener(i[1],function(){e.apply(t,r)})})};for(var i in this.mappings){t(i)}}},{key:"applyAll",value:function(){for(var e in this.mappings)this.apply(e,this.mappings[e].rules)}},{key:"apply",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?null:arguments[0],i=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if(null!==t&&null!==i){var n=this.find(t.toString());if(0!==n.length)if("jquery"===this.findType)for(var r in i){var o=this.computeRule(i[r],r,n);n.css(r,o)}else"sizzle"===this.findType&&n.map(function(t){var n="";for(var r in i){var o=e.computeRule(i[r],r,t);n+=r+": "+o+"; "}n=n.slice(0,-1),t.setAttribute("style",n)})}}},{key:"computeRule",value:function(e,t,i){"function"==typeof e&&(e=e(i));var n=["font-weight","opacity"];return Number(e)===e&&n.indexOf(t)<0?e.toString()+"px":e.toString()}},{key:"nestSelector",value:function(e,t){var i=" ";return this.selIsAppending(e)&&(i="",e=e.substring(1)),t+i+e}},{key:"parseKey",value:function(e){var t=this.isMeta(e),i=this.isRule(e);return{key:e,type:t?this.meta:i?this.rule:this.selector}}},{key:"parseMixins",value:function(e,t){var i=e[this.mixins];Array.isArray(i)||(i=[i]);for(var n in i){var r=i[n];if(null===r||"object"!==("undefined"==typeof r?"undefined":_typeof(r)))throw"'"+t+"' tree has an invalid _mixins value. _mixins can only be an object literal or array of object literals.";for(var o in r)e.hasOwnProperty(o)&&null!==e[o]||(e[o]=r[o])}return delete e[this.mixins],e}},{key:"isMeta",value:function(e){var t=[this.mixins,this.listeners];return t.indexOf(e)>-1}},{key:"selIsAppending",value:function(e){return"&"===e.substr(0,1)}},{key:"isRule",value:function(e){return this.rules.indexOf(e)>-1}}]),e}();